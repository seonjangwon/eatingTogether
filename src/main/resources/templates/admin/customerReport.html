<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <link href="/css/form.css" rel="stylesheet" crossorigin="anonymous">
    <meta charset="UTF-8">
    <meta name="_csrf" th:content="${_csrf.token}">
    <meta name="_csrf_header" th:content="${_csrf.headerName}">
    <title>íšŒì›ì‹ ê³ í˜ì´ì§€</title>
    <script src="https://code.jquery.com/jquery-3.6.0.js"></script>
    <script>
    const reportbtn = () => {
        // fomdata = $("#report_form").serialize();
        const customerNum = $('#customerNumber').val();
        console.log(customerNum);
        const loginEmail = document.getElementById('loginEmail').value;
        console.log(loginEmail);
        const opinion = document.getElementById('reportOpinion').value;
        console.log(opinion);

        const check = document.getElementsByName('reportCause').values;

        var header = $("meta[name='_csrf_header']").attr('content');
        var token = $("meta[name='_csrf']").attr('content');

        // nameì´ ê°™ì€ ì²´í¬ë°•ìŠ¤ìœ¼ ê°’ì„ ë°°ì—´ì— ë‹´ìŒ
        const reportCauseArr = [];
        $("input[name='reportCause']:checked").each(function(i){
            reportCauseArr.push($(this).val()); // ì²´í¬ëœ ê²ƒë§Œ ë½‘ì•„ì„œ ë°°ì—´ì— push
        });
        const form = $('#report_form').serialize();
        console.log(form);

        // console.log(reportCauseArr);
        //
        // // íšŒì›ë²ˆí˜¸ë‘ ì²´í¬ë°•ìŠ¤ê°’(ë°°ì—´)ì„ name/value í˜•íƒœë¡œ ë‹´ìŒ
        // const Data = JSON.stringify({customerNumber : customerNum,
        //     customerLoginEmail : loginEmail,
        //     reportCause : check,
        //     reportOpinion : opinion});
        //
        // console.log(Data);

        $.ajax({
            url: "/admin/customerReport",
            type: "post",
            data: form,
            dataType: 'text', // ê°’ ë°›ì•„ì˜¤ëŠ” íƒ€ì…
            // contentType : 'application/json', // ë³´ë‚´ëŠ” íƒ€ì…
            beforeSend: function(xhr){
                xhr.setRequestHeader(header, token);
            },
            success: function(result){
                console.log('ì„±ê³µ');
                console.log(result);
            },
            error: function(){
                console.log('ì‹¤íŒ¨');
            }
        });


    }
    </script>
</head>
<style>
    a{ text-decoration-line: none; }   /* í•˜ì´í¼ë§í¬ ê¾¸ë°ˆìš”ì†Œ ì‚­ì œ */
    a:link    {
        color: sandybrown;
    } /* í•˜ì´í¼ë§í¬ ê´€ë ¨ */
    a:visited {
        color: sandybrown;
    }
    a:hover   {
        color: coral;
    }
    a:active  {
        color: deeppink;
    }
</style><!-- í•˜ì´í¼ë§í¬ìš©: ìˆ˜ì •ê°€ëŠ¥ì„± ìˆìŒ -->
<body>
<header>
    <div class = "container">
        <div class = "row">
            <div class = "col-3">
                <span id = logoTitle>
                    <h3><a href="/"> ğŸ™ ë­ë¨¹ì„ê¹Œìš”?</a></h3>
                </span>
            </div>
            <div class = "col-2">
                <!-- ê³µë°±ë€ -->
            </div>
            <div class = "col-2">
                <!--<form class="d-flex" id="menuBar-search">
                  <input class="form-control me-sm-2" type="text" placeholder="Search">
                  <button class="btn btn-secondary my-2 my-sm-0" type="submit">Search</button>
                </form>-->
            </div>
            <div class="col-4">
                <span id= "menuBar-text">
                       <a href="/usual/logout"> ë¡œê·¸ì•„ì›ƒ</a>
                        <a href="/customer/"> ë§ˆì´í˜ì´ì§€</a>
                        <a href="/customer/basket"> ì¥ë°”êµ¬ë‹ˆ</a>
                </span>
            </div>
            <div class="col" id="menuBar-friPan">
                <a href="#" class="btn btn-light btn-sm " tabindex="-1" role="button" aria-disabled="true">ğŸ³</a>
                <!--<button class="btn btn-right" id="menuBar-offCanvas" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasRight" aria-controls="offcanvasRight">ğŸ³</button>-->
            </div>
        </div>
    </div>
</header><!--header í—·ê°ˆë¦¬ë‹ˆê¹Œ ì ‘ì–´ë‘ê³  ì‚¬ìš©í•˜ê¸°! ì´ë™í•  menu text & link ì²´í¬í•´ì£¼ì„¸ìš”~-->
<section>
<form id="report_form">
    <input type="hidden" id="customerNumber" name="customerNumber" th:value="${customerNumber}" > <!--íšŒì›ë²ˆí˜¸?-->
    <input type="hidden" id="loginEmail" name="customerLoginEmail" th:value="${session['customerLoginEmail']}">
<filedset>
    <input type="checkbox" name="reportCause" value="1"> ì£¼ë¬¸ê³¼ ê´€ë ¨ì—†ëŠ” ë‚´ìš©
    <input type="checkbox" name="reportCause" value="2"> ìŒë€ì„±, ìš•ì„¤ ë“± ë¶€ì ì ˆí•œ ë‚´ìš©
    <input type="checkbox" name="reportCause" value="3"> ë¶€ì ì ˆí•œ í™ë³´ ë˜ëŠ” ê´‘ê³ 
    <input type="checkbox" name="reportCause" value="4"> ê°œì¸ì •ë³´ ìœ ì¶œìœ„í—˜
    <input type="checkbox" name="reportCause" value="5"> ë¦¬ë·°ì‘ì„± ì·¨ì§€ì— ë§ì§€ ì•ŠëŠ” ë‚´ìš©
</filedset>
    <textarea id="reportOpinion" name="reportOpinion" cols="70" roww="4"></textarea>
</form>
    <input type="button" value="ì‹ ê³ í•˜ê¸°" onclick="reportbtn()">
</section>
<footer></footer>
</body>
</html>