<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
  <meta charset="UTF-8">
  <title>[뭐먹을까요:업체] 메뉴수정</title>
  <script src="https://code.jquery.com/jquery-3.6.0.js"></script>
  <script>
    const menuUpdate_btn = () => {
      /*let menuUpdateData = new FormData($('#updateForm'));*/
      let menuUpdateData = new FormData();
      menuUpdateData.append("number",$('#menu_number').val());
      menuUpdateData.append("name",$('#menu_name').val());
      menuUpdateData.append("explain",$('#menu_explain').val());
      menuUpdateData.append("price",$('#menu_price').val());
      menuUpdateData.append("file",$('#menu_file')[0]);
      //새로운 form #updateForm에 [0] = 1개의 데이터를 담아 menuUpdateData에 넣음
      const id = document.querySelector('#menu_number').value;
      console.log(menuUpdateData);

      $.ajax ({
        type: 'put',
        url: '/store/update/' + id, // localhost/store/update/{menuNumber} 형식
        precessData: false,
        contentType: false,
        cache: false,
        data: menuUpdateData,
        success: function ()  {
          location.href = "/store/update/";
          console.log("menuUpdateBtn 성공")
        }, error : function ()  {
          alert("ajax 아작아작")
        }
      });
    }
  </script>
</head>
<body>

  <section id="menuUpdate">
  <span th:text="${session['storeLoginEmail']}"}> </span>
  님
    <h4> <span th:text="*{menu.menuName}"> </span> 메뉴 수정 </h4>

    <form id="updateForm" enctype="multipart/form-data">

      <input type="hidden" id="menu_number" th:value="${menu.menuNumber}">
      <input type="text" id="menu_name" name="menuName" th:value="${menu.menuName}" placeholder="메뉴이름"><br>
      <input type="text" id="menu_explain" name="menuExplain" th:value="${menu.menuExplain}" placeholder="메뉴설명"><br>
      <input type="text" id="menu_price" name="menuPrice" th:value="${menu.menuPrice}" placeholder="가격"><br>
      <input type="file" id="menu_file" name="menuFile" th:value="${menu.menuFilename}" placeholder="메뉴사진"><br>
      <img th:src="@{|/upload/${menu.menuFile}|}" alt="사진"><br>
      <input type="hidden" name="storeNumber" th:value="${menu.storeNumber}"><br>
    </form>
    <button th:onclick="menuUpdate_btn([[${menu.menuNumber}]])"> 수정ajax</button>
  </section>


</body>
</html>